# FMO 日志查看器

FMO 日志查看器是一款专业的 **FMO 日志管理与分析工具**，提供日志导入、实时同步、数据查询、统计分析以及 APRS 远程控制等功能。本项目由 **BH5HSJ 后视镜** 开发并开源，采用 MIT 许可证。

📦 [GitHub 仓库](https://github.com/dingle1122/FmoLogs) · 🐛 [问题反馈](https://github.com/dingle1122/FmoLogs/issues)

## ✨ 主要功能

### 📁 数据导入与导出

- **导入 FMO 日志**：支持导入一个或多个 `.db` 格式的日志文件
- **FMO 同步**：
  - **自动同步**：配置 FMO 地址后，自动检测并提示同步今日消息
  - **手动同步**：一键同步今日通联记录
- **数据持久化**：使用 IndexedDB 存储，刷新页面数据不丢失
- **数据导出**：将当前查看的日志数据导出为 `.db` 文件
- **日志备份**：一键从 FMO 设备下载完整的日志备份文件

### 📡 服务器与设备管理

- **服务器列表**：查看所有可用服务器（Station）状态
- **服务器切换**：支持切换当前连接的服务器（上一台/下一台/列表选择）
- **实时监控**：
  - **发言状态**：实时显示当前正在发言的呼号及发言历史
  - **状态监控**：标题栏显示服务器连接状态
- **APRS 远程控制**：集成专业的 APRS 远程控制面板，支持 FMO 设备远程管理
  - **智能填充**：自动从 FMO 配置中填充登录呼号，简化操作流程
  - **安全校验**：严格的呼号、Passcode 和密钥格式校验，防止误操作
  - **服务器管理**：支持添加、编辑、删除自定义远程控制服务器
  - **多模式控制**：支持普通模式、待机模式、软重启三种控制指令
  - **操作记录**：完整的操作历史记录，支持中文状态显示（普通模式、待机模式、软重启）
  - **自动断开**：发送指令后 60 秒自动断开连接，节省资源
  - **状态反馈**：实时显示连接状态和指令执行结果，直观可靠

### 📊 专业查询模式

#### 1. 综合日志视图

- **全量记录**：按时间倒序展示所有通联日志
- **智能搜索**：支持按接收方呼号实时模糊搜索
- **当日序号**：高亮显示当日通联序号（前三名金银铜色高亮）
- **详细信息**：展示呼号、网格、频率、模式、中继及留言信息

#### 2. 通联排名（TOP20）

- **多维统计**：接收方呼号、网格、中继使用频率的 TOP20 排名
- **数据筛选**：支持按发送方呼号筛选统计结果

#### 3. 老朋友视图

- **卡片展示**：以卡片形式展示历史通联过的友台
- **状态标识**：今日通联过的友台显示绿色高亮
- **历史回溯**：点击卡片即可查看与该友台的所有历史通联记录

### 🛠️ 实用工具

- **FMO 地址配置**：支持 IP 或 `fmo.local` 域名（自动处理 mDNS）
- **友情链接**：内置 FMO 地图、实践分享等常用资源链接
- **暗色模式**：自动跟随系统主题，提供舒适的夜间使用体验

## 🚀 使用指南

### 快速开始

1. **配置设备**：点击右上角设置图标，输入 FMO 设备地址（如 `fmo.local` 或 IP）
2. **同步数据**：点击"同步今日通联"获取最新数据，或手动导入 `.db` 文件
3. **开始使用**：在首页查看日志、统计或管理服务器

### mDNS 支持

- **桌面端**：推荐使用 `fmo.local` 直接连接
- **移动端**：部分设备可能需要输入具体 IP 地址

### 常见操作

- **切换服务器**：在"发言状态条"点击服务器名称，或在"发言历史"弹框中切换
- **导出/备份**：
  - **导出数据文件**：将当前网页中查看到的日志保存到本地
  - **备份 FMO 日志**：从 FMO 设备下载原始日志文件

## 💻 本地开发

### 环境要求

- Node.js 16+
- npm 或 yarn

### 快速开始

```bash
# 克隆仓库
git clone https://github.com/dingle1122/FmoLogs.git
cd FmoLogs

# 安装依赖
npm install

# 启动开发服务器（支持局域网访问）
npm run dev -- --host

# 代码格式化
npm run format

# 代码检查
npm run lint
```

## 📝 技术栈

- **核心框架**：Vue 3 (Composition API) + Vite 7
- **状态管理**：Pinia
- **数据存储**：SQLite (sql.js) + IndexedDB
- **通信协议**：WebSocket (实时事件) + HTTP/HTTPS
- **路由管理**：Vue Router
- **加密算法**：crypto-js (HMAC-SHA1)
- **代码规范**：ESLint + Prettier

## 📦 构建部署

```bash
# 构建生产版本
npm run build

# 本地预览构建产物
npm run preview
```

构建产物位于 `dist/` 目录，可部署至任何静态文件服务器（如 Nginx、Apache、GitHub Pages、Vercel 等）。

## 📂 项目结构

```
src/
├── components/          # Vue 组件
│   ├── common/         # 通用组件（对话框、日期选择器等）
│   └── home/           # 主页组件（表格、查询、统计等）
│       └── modals/     # 弹窗组件（设置、详情、APRS 控制等）
├── composables/        # 组合式 API（业务逻辑）
│   ├── useAprsControl.js    # APRS 远程控制
│   ├── useDataQuery.js      # 数据查询
│   ├── useDbManager.js      # 数据库管理
│   ├── useFmoSync.js        # FMO 同步
│   ├── useSettings.js       # 应用设置
│   ├── useSpeakingStatus.js # 发言状态
│   └── useToast.js          # 提示消息
├── services/           # 服务层
│   ├── db.js          # IndexedDB 操作
│   └── fmoApi.js      # FMO API 封装
├── stores/            # Pinia 状态管理
├── router/            # 路由配置
├── utils/             # 工具函数
└── views/             # 页面视图
```

## 🙏 特别感谢

- **BG5ESN**：提供完美的 FMO 硬件平台
- **BG9JYT**：提供甘肃集群服务器，并提供被控支持
- **BG2LRU、BD6JDU、BI3SQP 等各位友台**：提供宝贵的想法和建议

## 📄 开源许可

本项目采用 [MIT License](./LICENSE) 开源许可证。

## 👨‍💻 贡献者

- **BH5HSJ 后视镜**：项目创建与主要开发
- **BG9JYT**：APRS 远程控制功能开发

欢迎提交 Issue 和 Pull Request！
